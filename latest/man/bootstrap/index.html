
<!DOCTYPE html>
<html class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="PhyloNetworks is a Julia package for the manipulation, visualization and inference of phylogenetic networks.">
      
      
      
        <meta name="author" content="Claudia Sol&iacute;s-Lemus">
      
      
        <link rel="shortcut icon" href="../../assets/images/favicon.ico">
      
      <meta name="generator" content="mkdocs-0.16.1, mkdocs-material-1.0.5">
    
    
      
        <title>Bootstrap - PhyloNetworks.jl</title>
      
    
    
      <script src="../../assets/javascripts/modernizr-56ade86843.js"></script>
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application-9c62e3c932.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-02ce7adcc2.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../assets/Documenter.css">
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="teal" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="PhyloNetworks.jl" class=" md-logo  md-header-nav__button">
          
            <img src="../../snaq_small.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Manual
                </span>
              
            
            Bootstrap
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <div class="md-search__overlay"></div>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false">
      <label class="md-icon md-search__icon" for="search"></label>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result"></div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            
              


  


  <a href="https://github.com/crsl4/PhyloNetworks.jl" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

            
          </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <i class=" md-logo  md-nav__button">
      
        <img src="../../snaq_small.png">
      
    </i>
    PhyloNetworks.jl
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/crsl4/PhyloNetworks.jl" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  <li class="md-nav__item">
    
      <a href="../.." title="Home" class="md-nav__link">
        Home
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Manual
    </label>
    <nav class="md-nav" data-md-component="collapsible">
      <label class="md-nav__title" for="nav-2">
        Manual
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
  <li class="md-nav__item">
    
      <a href="../installation/" title="Installation" class="md-nav__link">
        Installation
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../inputdata/" title="Input Data for SNaQ" class="md-nav__link">
        Input Data for SNaQ
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../ticr_howtogetQuartetCFs/" title="TICR pipeline" class="md-nav__link">
        TICR pipeline
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../snaq_plot/" title="Network estimation and display" class="md-nav__link">
        Network estimation and display
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../fixednetworkoptim/" title="Fixed Network" class="md-nav__link">
        Fixed Network
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../expectedCFs/" title="Extract Expected CFs" class="md-nav__link">
        Extract Expected CFs
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Bootstrap
      </label>
    
    <a href="./" title="Bootstrap" class="md-nav__link md-nav__link--active">
      Bootstrap
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#running-a-bootstrap-analysis" title="Running a bootstrap analysis" class="md-nav__link">
    Running a bootstrap analysis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summarizing-bootstrap-on-the-main-tree" title="Summarizing bootstrap on the main tree" class="md-nav__link">
    Summarizing bootstrap on the main tree
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summarizing-bootstrap-on-reticulations" title="Summarizing bootstrap on reticulations" class="md-nav__link">
    Summarizing bootstrap on reticulations
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../multiplealleles/" title="Multiple Alleles" class="md-nav__link">
        Multiple Alleles
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../trait_tree/" title="Trait Evolution" class="md-nav__link">
        Trait Evolution
      </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Library
    </label>
    <nav class="md-nav" data-md-component="collapsible">
      <label class="md-nav__title" for="nav-3">
        Library
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
  <li class="md-nav__item">
    
      <a href="../../lib/public/" title="Public" class="md-nav__link">
        Public
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../../lib/internals/" title="Internals" class="md-nav__link">
        Internals
      </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#running-a-bootstrap-analysis" title="Running a bootstrap analysis" class="md-nav__link">
    Running a bootstrap analysis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summarizing-bootstrap-on-the-main-tree" title="Summarizing bootstrap on the main tree" class="md-nav__link">
    Summarizing bootstrap on the main tree
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summarizing-bootstrap-on-reticulations" title="Summarizing bootstrap on reticulations" class="md-nav__link">
    Summarizing bootstrap on reticulations
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
               
                 <a href="https://github.com/crsl4/PhyloNetworks.jl/edit/master/docs/man/bootstrap.md" title="Edit this page" class="md-icon md-content__edit">edit</a>
               
              
                
                <p><a id='Bootstrap-1'></a></p>
<h1 id="bootstrap">Bootstrap</h1>
<p><a id='Running-a-bootstrap-analysis-1'></a></p>
<h2 id="running-a-bootstrap-analysis">Running a bootstrap analysis</h2>
<p>We can run a bootstrap analysis if we estimated quartet concordance factors (CFs) with credibility intervals, such as if we used the <a href="../ticr_howtogetQuartetCFs/#TICR-pipeline-1">TICR pipeline</a>. This pipeline provides a CF table with extra columns for credibility intervals.</p>
<pre><code class="julia">using DataFrames
df = readtable(&quot;tableCFCI.csv&quot;)
bootnet = bootsnaq(T, df, hmax=1, nrep=10, runs=3, filename=&quot;bootstrap&quot;)
</code></pre>

<p>This example file can be accessed <a href="https://github.com/crsl4/PhyloNetworks/blob/master/examples/tableCFCI.csv">here</a> or <a href="https://raw.githubusercontent.com/crsl4/PhyloNetworks/master/examples/tableCFCI.csv">here</a>. Make sure that your downloaded file has the name <code>tableCFCI.csv</code> (to match the name in the Julia command), with no an extra extension <code>.txt</code>. Rename the file after download if necessary.</p>
<p>This example uses a number of replicates (10) that is definitely too small, to make the example run faster. You might also increase the number of optimization runs (<code>runs</code>) done for each bootstrap replicate.</p>
<p>The bootstrap networks are saved in the <code>boostrap.out</code> file, so they can be read in a new session with <code>bootnet = readMultiTopology("boostrap.out")</code>. To save the bootstrap networks to a different file (perhaps after having re-rooted them with an outgroup), you can do this:</p>
<pre><code class="julia">writeMultiTopology(bootnet, &quot;bootstrapNets_h1.tre&quot;)
length(bootnet) # 10 networks in the array 'bootnet'
less(&quot;bootstrapNets_h1.tre&quot;)
</code></pre>

<p>If you close your session and re-open it later, you can re-read the bootstrap networks back in memory like this:</p>
<pre><code class="julia">bootnet = readMultiTopology(&quot;bootstrapNets_h1.tre&quot;);
</code></pre>

<p>We can run bootstrap analysis from gene trees also. We need a text file with a list of files containg the bootstrap trees (one file per gene). This is the same format used by ASTRAL (see the wiki page for more details.).</p>
<pre><code class="julia">bootTrees = readBootstrapTrees(&quot;BSlistfiles&quot;)
bootnet = bootsnaq(T, bootTrees, hmax=1, nrep=100, filename=&quot;bootsnaq1_raxmlboot&quot;)
</code></pre>

<p>If you used a specified list of quartets on the original data, you should use that same list for the bootstrap analysis through the option <code>quartetfile</code>.</p>
<p><a id='Summarizing-bootstrap-on-the-main-tree-1'></a></p>
<h2 id="summarizing-bootstrap-on-the-main-tree">Summarizing bootstrap on the main tree</h2>
<p>The <code>bootsnaq</code> function, as used before, returned a list of 10 networks (<code>nrep=10</code>). Before summarizing them on the best network, it is best to re-read this network to get a reproducible internal numbering of its nodes and edges, used later for mapping bootstrap support to edges. We can then summarize bootstrap networks:</p>
<pre><code class="julia">net1 = readTopology(&quot;net1_snaq.out&quot;) # reading from output file of snaq
BStable, tree1 = treeEdgesBootstrap(bootnet,net1)
</code></pre>

<p>This will calculate the major tree <code>tree1</code> displayed in <code>net1</code>, that is, the tree obtained by following the major parent (γ&gt;0.5) of each hybrid node. This tree can be visualized like this, with edge numbers shown for later use.</p>
<pre><code class="julia">rootatnode!(net1, &quot;4&quot;)
rootatnode!(tree1, &quot;4&quot;)
plot(tree1, showEdgeNumber=true)
</code></pre>

<p>Next, we can look at bootstrap table <code>BStable</code>, which has one row for each tree edge in <code>net1</code>. One column contains the edge number (same as shown in the plot) and another column contains the edge bootstrap support: the proportion of bootstrap replicates in which this edge was found in the major tree of the inferred network. We can see the full bootstrap table and see which tree edges have bootstrap support lower than 100% with</p>
<pre><code class="julia">showall(BStable)
BStable[BStable[:proportion] .&lt; 1.0, :]
</code></pre>

<p>Finally, we can map the bootstrap proportions onto the network or its main tree by passing the bootstrap table to the <code>edgeLabel</code> option of <code>plot</code>:</p>
<pre><code class="julia">plot(tree1, edgeLabel=BStable)
plot(net1,  edgeLabel=BStable)
</code></pre>

<p>(Here, it is important that the numbers assigned to edges when building the boostrap table –those in <code>net1</code> at the time– correspond to the current edge numbers in <code>tree1</code> and <code>net1</code>. That was the purpose of reading the network from the output file of snaq! earlier, for consistency across different Julia sessions.)</p>
<p>If we wanted to plot only certain bootstrap values, like those below 100% (1.0), we could do this:</p>
<pre><code class="julia">plot(net1, edgeLabel=BStable[BStable[:proportion] .&lt; 1.0, :])
</code></pre>

<p><a id='Summarizing-bootstrap-on-reticulations-1'></a></p>
<h2 id="summarizing-bootstrap-on-reticulations">Summarizing bootstrap on reticulations</h2>
<p>Summarizing the placement of hybridization edges is not standard. The function <code>hybridBootstrapSupport</code> attempts to do so. The descendants of a given hybrid node form the "recipient" or "hybrid" clade, and is obtained after removing all other reticulations. If reticulation is due to gene flow or introgression, the minor hybrid edge (with γ&lt;0.5) represents this event. The descendants of the lineage from which gene flow originated is then a second "sister" of the hybrid clade. Because of the reticulation event, the hybrid clade has 2 sister clades, not 1: the major sister (through the major hybrid edge with γ&gt;0.5) and the minor sister (through the minor hybrid edge with γ&lt;0.5). Note that the network says <em>nothing</em> about the process: its shows the <em>relationships</em> only. We can calculate the frequency that each clade is a hybrid clade, or a major or minor sister for some other hybrid, in the bootstrap networks:</p>
<pre><code class="julia">BSn, BSe, BSc, BSgam, BSedgenum = hybridBootstrapSupport(bootnet, net1);
</code></pre>

<p>Let's look at the results. We can list all the clades and the percentage of bootstrap networks (bootstrap support) in which each clade is a hybrid or sister to a hybrid:</p>
<pre><code class="julia">BSn
</code></pre>

<p>If a clade contains a single taxon, it is listed with its taxon name. The clade found in the best network is listed with its tag, starting with H (e.g. "H7"). The name of other clades start with "c_" followed by their number in the best network, if they do appear in the best network. The node numbers, as used internally in the best network, are listed in a separate column. They can be used later to display the bootstrap support values onto the network. Various columns give the bootstrap support that each clade is a hybrid, or a (major/minor) sister to a hybrid. The last column gives the bootstrap support for the full relationship in the best network: same hybrid with same two sisters. These bootstrap values are associated with nodes (or possibly, their parent edges).</p>
<p>To see what is the clade named "H7", for instance:</p>
<pre><code class="julia">BSc # this might be too big
showall(BSc)
BSc[:taxa][BSc[:H7]]
</code></pre>

<p>We can also get bootstrap values associated with edges, to describe the support that a given hybrid clade has a given sister clade.</p>
<pre><code class="julia">BSe
</code></pre>

<p>Here, each row describes a pair of 2 clades: one being the hybrid, the other being its sister, connected by a hybrid edge. The first rows corresponds to hybrid edges in the best network. Other rows correspond to edges seen in bootstrap networks but not in the best network.</p>
<pre><code class="julia">BSedgenum
</code></pre>

<p>lists all the hybrid edges in the best network, two for each hybrid node: the major parent edge and then the minor parent edge. In our case, there is only one reticulation, so only 2 hybrid edges.</p>
<p>We can plot the bootstrap values of the 2 hybrid edges in the best network:</p>
<pre><code class="julia">plot(net1, edgeLabel=BSe[[:edge,:BS_hybrid_edge]])
</code></pre>

<p>This is showing the bootstrap support each hybrid edge: percentage of bootstrap trees with an edge from the same sister clade to the same hybrid clade. Alternatively, we could show the bootstrap support for the full reticulation relationships in the network, one at each hybrid node (support for same hybrid with same sister clades):</p>
<pre><code class="julia">plot(net1, nodeLabel=BSn[[:hybridnode,:BS_hybrid_samesisters]])
</code></pre>

<p>On a different plot, we can show the bootstrap support for hybrid clades, shown on the parent edge of each node with positive hybrid support:</p>
<pre><code class="julia">plot(net1, edgeLabel=BSn[BSn[:BS_hybrid].&gt;0, [:edge,:BS_hybrid]])
</code></pre>

<p>or plot the support for minor sister clades (shown along parent edge, and filtered to those with sister support &gt; 5%):</p>
<pre><code class="julia">plot(net1, edgeLabel=BSn[BSn[:BS_minor_sister].&gt;5, [:edge,:BS_minor_sister]])
</code></pre>

<p>To plot the same values next to the associated nodes, rather than edges, we use the option <code>nodeLabel</code> and we select the column <code>node</code> or <code>hybridnode</code>:</p>
<pre><code class="julia">plot(net1, nodeLabel=BSn[BSn[:BS_hybrid].&gt;0, [:hybridnode,:BS_hybrid]])
plot(net1, nodeLabel=BSn[BSn[:BS_minor_sister].&gt;5, [:node,:BS_minor_sister]])
plot(net1, nodeLabel=BSn[BSn[:BS_major_sister].&gt;5, [:node,:BS_major_sister]])
</code></pre>

<p>The estimated heritability γ on hybrid edges in the reference network, when present in a bootstrap network, was also extracted:</p>
<pre><code class="julia">BSgam
</code></pre>

<p>γ=0 values are for bootstrap replicates that did not have the edge in their network. Basic summaries on γ values for a given edge, say the minor parent, could be obtained like this:</p>
<pre><code class="julia">minimum(BSgam[:,2])
maximum(BSgam[:,2])
mean(BSgam[:,2])
std(BSgam[:,2])
</code></pre>
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../expectedCFs/" title="Extract Expected CFs" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Extract Expected CFs
              </span>
            </div>
          </a>
        
        
          <a href="../multiplealleles/" title="Multiple Alleles" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Multiple Alleles
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application-f7ac33b6fb.js"></script>
      <script>app.initialize({url:{base:"../.."}})</script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../../assets/mathjaxhelper.js"></script>
      
    
    
      
    
  </body>
</html>